{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}
<section class="py-20 bg-muted/30">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between mb-12">
      <div class="text-center flex-1">
        <h2
          class="font-serif text-4xl md:text-5xl lg:text-6xl font-bold mb-4"
          style="font-family: var(--font-playfair);"
        >
          WHIFF MAKERS
        </h2>
        <p class="text-xl text-muted-foreground">Browse our collection of heat and water-free machines[diffusers]</p>
      </div>
    </div>
    <div class="relative">
      <!-- Swiper CSS -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">

      <div class="swiper collection-swiper">
        <div class="swiper-wrapper">
          {% assign collection = collections['whiff-makers'].products %}
          {% for product in collection limit: 7 %}
            <div class="swiper-slide">
              <div
                data-slot="card"
                class="text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm group overflow-hidden bg-card border-border hover:border-primary transition-all duration-300 h-full"
              >
                <div class="relative h-[300px] overflow-hidden">
                  {%- if product.featured_image -%}
                    <img
                      alt="{{ product.featured_image.alt | escape }}"
                      loading="lazy"
                      decoding="async"
                      data-nimg="fill"
                      width="400"
                      height="300"
                      class="object-cover group-hover:scale-105 transition-transform duration-500"
                      src="{{ product.featured_image | image_url: width: 400, height: 300 }}"
                      style="position: absolute; height: 100%; width: 100%; inset: 0px; color: transparent;"
                    >
                  {%- endif -%}

                  {%- comment -%} Smart Badge System {%- endcomment -%}
                  {%- assign badge_text = '' -%}
                  {%- assign badge_class = 'bg-primary text-primary-foreground' -%}

                  {%- if product.compare_at_price > product.price -%}
                    {%- assign discount_percentage = product.compare_at_price
                      | minus: product.price
                      | times: 100
                      | divided_by: product.compare_at_price
                    -%}
                    {%- assign badge_text = discount_percentage | append: '% OFF' -%}
                  {%- elsif product.tags contains 'new' -%}
                    {%- assign badge_text = 'NEW' -%}
                  {%- elsif product.tags contains 'bestseller' or product.tags contains 'popular' -%}
                    {%- assign badge_text = 'BESTSELLER' -%}
                  {%- elsif product.tags contains 'premium' or product.tags contains 'luxury' -%}
                    {%- assign badge_text = 'LUXURY' -%}
                  {%- endif -%}

                  {%- if badge_text != '' -%}
                    <div class="absolute top-4 right-4 {{ badge_class }} px-3 py-1 text-xs font-bold rounded-full">
                      {{ badge_text }}
                    </div>
                  {%- endif -%}
                </div>

                <div class="p-6">
                  <h3 class="text-lg font-bold mb-2 text-foreground">{{ product.title | upcase }}</h3>
                  <p class="text-sm text-muted-foreground mb-3 line-clamp-2">
                    {{ product.description | strip_html | truncate: 60 }}
                  </p>

                  <div class="flex items-center gap-1 mb-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="lucide lucide-star h-4 w-4 fill-primary text-primary"
                    >
                      <path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"></path>
                    </svg>
                    <span class="text-sm font-semibold">4.8</span>
                    <span class="text-xs text-muted-foreground">({{ 50 | plus: forloop.index | times: 3 }})</span>
                  </div>

                  <a
                    href="{{ product.url }}"
                    class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border shadow-xs dark:bg-input/30 dark:border-input dark:hover:bg-input/50 h-9 px-4 py-2 has-[>svg]:px-3 w-full border-primary text-primary hover:bg-primary hover:text-primary-foreground bg-transparent"
                  >
                    VIEW DETAILS
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
    <div class="text-center mt-12">
      <button
        data-slot="button"
        class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive shadow-xs h-10 rounded-md has-[&gt;svg]:px-4 bg-primary hover:bg-primary/90 text-primary-foreground px-12"
      >
        VIEW ALL SCENTS
      </button>
    </div>
  </div>

  <!-- Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

  <!-- Initialize Swiper -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const swiper = new Swiper('.collection-swiper', {
        slidesPerView: 1,
        spaceBetween: 24,
        loop: true,
        autoplay: {
          delay: 3000,
          disableOnInteraction: false,
          pauseOnMouseEnter: true,
        },
        navigation: {
          nextEl: '.collection-swiper-next',
          prevEl: '.collection-swiper-prev',
        },
        breakpoints: {
          640: {
            slidesPerView: 2,
            spaceBetween: 24,
          },
          1024: {
            slidesPerView: 4,
            spaceBetween: 24,
          },
        },
      });
    });
  </script>
</section>

{% schema %}
{
  "name": "Whif Collection Section",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "inline_richtext",
      "id": "heading",
      "default": "Our Collections",
      "label": "Heading"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Section padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "collection_item",
      "name": "Collection Item",
      "limit": 6,
      "settings": [
        {
          "type": "image_picker",
          "id": "collection_image",
          "label": "Collection image"
        },
        {
          "type": "text",
          "id": "collection_title",
          "default": "Collection Title",
          "label": "Collection title"
        },
        {
          "type": "textarea",
          "id": "collection_description",
          "label": "Collection description"
        },
        {
          "type": "url",
          "id": "collection_link",
          "label": "Collection link"
        },
        {
          "type": "text",
          "id": "button_text",
          "default": "Shop Collection",
          "label": "Button text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Whif Collection Section",
      "blocks": [
        {
          "type": "collection_item"
        },
        {
          "type": "collection_item"
        },
        {
          "type": "collection_item"
        }
      ]
    }
  ]
}
{% endschema %}
